<!--components/product-card/product-card.wxml-->
<view class="product-card {{cardType}}-card" bindtap="onCardTap">
  <!-- 商品图片 -->
  <view class="card-image-container">
    <image 
      class="card-image" 
      src="{{product.images[0].url || product.images[0] || 'https://picsum.photos/400/300?random=0'}}" 
      mode="aspectFill"
      bindtap="onImageTap"
      catchtap
    ></image>
    
    <!-- 标签 -->
    <view wx:if="{{product.tags && product.tags.length > 0}}" class="card-tags">
      <text wx:for="{{product.tags}}" wx:key="*this" class="tag">{{item}}</text>
    </view>
    
    <!-- 操作按钮 -->
    <view class="card-actions">
      <!-- 收藏按钮 -->
      <view 
        wx:if="{{showFavorite}}" 
        class="action-btn favorite-btn {{isFavorited ? 'favorited' : ''}}"
        bindtap="onFavoriteTap"
        catchtap
      >
        <text class="action-icon">{{isFavorited ? '♥' : '♡'}}</text>
      </view>
      
      <!-- 对比按钮 -->
      <view 
        wx:if="{{showCompare}}" 
        class="action-btn compare-btn {{isCompared ? 'compared' : ''}}"
        bindtap="onCompareTap"
        catchtap
      >
        <text class="action-icon">{{isCompared ? '✓' : '⚖'}}</text>
      </view>
    </view>
  </view>

  <!-- 商品信息 -->
  <view class="card-info">
    <!-- 商品名称 -->
    <text class="card-title">{{product.title || product.name || '商品名称'}}</text>
    
    <!-- 品牌信息 -->
    <text class="card-brand">{{product.brand}}</text>
    
    <!-- 价格信息 -->
    <view class="card-price">
      <text class="monthly-price">¥{{product.monthlyPrice || Math.ceil(product.price/50) || 0}}/月</text>
      <text wx:if="{{product.price}}" class="original-price">
        原价¥{{product.price}}
      </text>
    </view>
    
    <!-- 尺寸信息 (仅列表模式显示) -->
    <view wx:if="{{cardType === 'list'}}" class="card-dimensions">
      <text class="dimensions-text">
        {{product.width_mm/10}}×{{product.depth_mm/10}}×{{product.height_mm/10}}cm
      </text>
    </view>
    
    <!-- 额外信息 (仅列表模式显示) -->
    <view wx:if="{{cardType === 'list'}}" class="card-extra">
      <view class="extra-item">
        <text class="extra-label">风格：</text>
        <text class="extra-value">{{product.style ? product.style.join('、') : '未知'}}</text>
      </view>
      <view class="extra-item">
        <text class="extra-label">材质：</text>
        <text class="extra-value">{{product.material ? product.material.join('、') : '未知'}}</text>
      </view>
      <view class="extra-item">
        <text class="extra-label">颜色：</text>
        <text class="extra-value">{{product.color ? product.color.join('、') : '未知'}}</text>
      </view>
    </view>
    
    <!-- 库存状态 -->
    <view class="card-status">
      <text class="status-text {{(product.stock && product.stock[0] && product.stock[0].qty > 0) ? 'available' : 'unavailable'}}">
        {{(product.stock && product.stock[0] && product.stock[0].qty > 0) ? '现货' + product.stock[0].qty + '件' : '暂时缺货'}}
      </text>
    </view>
  </view>
</view>
