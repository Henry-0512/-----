<!-- components/product-card/product-card.wxml -->
<view class="product-card {{cardType === 'grid' ? 'grid-card' : 'list-card'}}" bindtap="onCardTap">
  <!-- å¡ç‰‡å®¹å™¨ -->
  <view class="card">
    <!-- é¡¶éƒ¨å›¾ç‰‡åŒºåŸŸ - å æ•´å¡å®½åº¦ -->
    <view class="media">
      <image 
        class="img" 
        src="{{safeProduct.images && safeProduct.images[0] ? safeProduct.images[0].url : safeProduct.image || 'https://picsum.photos/400/300?random=' + safeProduct.id}}" 
        mode="aspectFill" 
        lazy-load="true"
        bindtap="onImagePreview"
        catchtap
      />
      
      <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
      <view class="actions">
        <view 
          class="action-btn favorite-btn {{isFavorited ? 'favorited' : ''}}"
          bindtap="onToggleFavorite"
          catchtap
        >
          <text class="action-icon">{{isFavorited ? 'â¤ï¸' : 'ğŸ¤'}}</text>
        </view>
        <view 
          class="action-btn compare-btn {{isCompared ? 'compared' : ''}}"
          bindtap="onToggleCompare"
          catchtap
        >
          <text class="action-icon">{{isCompared ? 'ğŸ“Š' : 'ğŸ“ˆ'}}</text>
        </view>
      </view>
    </view>

    <!-- å•†å“ä¿¡æ¯åŒºåŸŸ -->
    <view class="info">
      <!-- æ ‡é¢˜ -->
      <text class="title">{{safeProduct.title || safeProduct.name}}</text>
      
      <!-- å“ç‰Œ -->
      <text class="brand">{{safeProduct.brand}}</text>

      <!-- ç²¾ç®€ä»·æ ¼è¡Œ -->
      <view class="meta-row">
        <!-- ä»·æ ¼chip - askæ¨¡å¼ä¸‹éšè— -->
        <text wx:if="{{priceText}}" class="price-chip">{{priceText}}</text>
        
        <!-- å°å·å’¨è¯¢æŒ‰é’® -->
        <ask-price-button
          wx:if="{{priceInfo.mode === 'ask'}}"
          label="å’¨è¯¢"
          size="sm"
          fullWidth="{{false}}"
          variant="outline"
          data="{{buttonData}}"
          bind:tap="onPriceInquiry"
        />
      </view>

      <!-- åº“å­˜å¾½æ ‡ -->
      <text wx:if="{{safeProduct.stock && safeProduct.stock[0]}}" class="stock">
        ç°è´§{{safeProduct.stock[0].qty}}ä»¶
      </text>
    </view>
  </view>
</view>