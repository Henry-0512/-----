<!-- components/product-card/product-card.wxml -->
<view class="product-card {{cardType === 'grid' ? 'grid-card' : 'list-card'}}" bindtap="onCardTap">
  <!-- 卡片容器 -->
  <view class="card">
    <!-- 顶部图片区域 - 占整卡宽度 -->
    <view class="media">
      <image 
        class="img" 
        src="{{safeProduct.images && safeProduct.images[0] ? safeProduct.images[0].url : safeProduct.image || 'https://picsum.photos/400/300?random=' + safeProduct.id}}" 
        mode="aspectFill" 
        lazy-load="true"
        bindtap="onImagePreview"
        catchtap
      />
      
      <!-- 操作按钮区域 -->
      <view class="actions">
        <view 
          class="action-btn favorite-btn {{isFavorited ? 'favorited' : ''}}"
          bindtap="onToggleFavorite"
          catchtap
        >
          <text class="action-icon">{{isFavorited ? '❤️' : '🤍'}}</text>
        </view>
        <view 
          class="action-btn compare-btn {{isCompared ? 'compared' : ''}}"
          bindtap="onToggleCompare"
          catchtap
        >
          <text class="action-icon">{{isCompared ? '📊' : '📈'}}</text>
        </view>
      </view>
    </view>

    <!-- 商品信息区域 -->
    <view class="info">
      <!-- 标题 -->
      <text class="title">{{safeProduct.title || safeProduct.name}}</text>
      
      <!-- 品牌 -->
      <text class="brand">{{safeProduct.brand}}</text>

      <!-- 精简价格行 -->
      <view class="meta-row">
        <!-- 价格chip - ask模式下隐藏 -->
        <text wx:if="{{priceText}}" class="price-chip">{{priceText}}</text>
        
        <!-- 小号咨询按钮 -->
        <ask-price-button
          wx:if="{{priceInfo.mode === 'ask'}}"
          label="咨询"
          size="sm"
          fullWidth="{{false}}"
          variant="outline"
          data="{{buttonData}}"
          bind:tap="onPriceInquiry"
        />
      </view>

      <!-- 库存徽标 -->
      <text wx:if="{{safeProduct.stock && safeProduct.stock[0]}}" class="stock">
        现货{{safeProduct.stock[0].qty}}件
      </text>
    </view>
  </view>
</view>