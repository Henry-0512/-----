<!-- components/product-card/product-card.wxml -->
<view class="product-card {{cardType === 'grid' ? 'grid-card' : 'list-card'}}">
  <!-- ÂõæÁâáÂå∫Âüü - ÁÇπÂáªËøõÂÖ•ËØ¶ÊÉÖ -->
  <view class="image-container" bindtap="onCardTap">
    <image 
      class="product-image" 
      src="{{safeProduct.images && safeProduct.images[0] ? safeProduct.images[0].url : safeProduct.image || 'https://picsum.photos/400/300?random=' + safeProduct.id}}" 
      mode="aspectFill" 
      lazy-load="true"
    />
    
    <!-- Êî∂ËóèÊåâÈíÆ -->
    <view 
      class="favorite-btn {{isFavorited ? 'favorited' : ''}}"
      bindtap="onToggleFavorite"
      catchtap
    >
      <text class="favorite-icon">{{isFavorited ? '‚ù§Ô∏è' : 'ü§ç'}}</text>
    </view>
    
    <!-- ÊàêËâ≤Ê†áÁ≠æ -->
    <view class="condition-tag">
      <text class="condition-text">{{conditionLabel}}</text>
    </view>
  </view>

  <!-- ÂïÜÂìÅ‰ø°ÊÅØÂå∫Âüü - ÁÇπÂáªË∑≥ËΩ¨ËØ¶ÊÉÖ -->
  <view class="product-info" bindtap="onCardTap">
    <!-- ÂïÜÂìÅÂêçÁß∞ -->
    <text class="product-name">{{safeProduct.title || safeProduct.name}}</text>
    
    <!-- ÂïÜÂìÅÊèèËø∞/ÂìÅÁâå -->
    <text class="product-desc">{{safeProduct.brand}}, {{productDesc}}</text>
    
    <!-- ‰ª∑Ê†ºÊàñÂí®ËØ¢Âå∫Âüü -->
    <view class="price-section">
      <!-- ‰ª∑Ê†ºÊ®°Âºè -->
      <view wx:if="{{priceInfo.mode !== 'ask'}}" class="price-row">
        <text class="price-main">¬£{{formattedPrice}}/mo</text>
      </view>
      
      <!-- Âí®ËØ¢Ê®°Âºè -->
      <view wx:else class="consult-container">
        <ask-price-button 
          label="Âí®ËØ¢‰ª∑Ê†º"
          fullWidth="{{false}}"
          size="sm"
          variant="outline"
          data="{{buttonData}}"
          bind:tap="onPriceInquiry"
        />
      </view>
    </view>
    
    <!-- ËØÑÂàÜÔºàÂ¶ÇÊûúÊúâÔºâ -->
    <view wx:if="{{safeProduct.rating}}" class="rating-section">
      <view class="stars">
        <block wx:for="{{5}}" wx:key="*this">
          <text class="star {{index < Math.floor(safeProduct.rating) ? 'filled' : ''}}">‚òÖ</text>
        </block>
      </view>
      <text class="rating-count">({{safeProduct.reviews || 0}})</text>
    </view>
    
    <!-- Êõ¥Â§öÈÄâÈ°π -->
    <text class="more-options">+ Options</text>
    
    <!-- Êñ∞Â¢ûÔºöÊñáÂ≠óÊåâÈíÆ -->
    <view class="card-actions" wx:if="{{cardType !== 'grid'}}">
      <button class="btn-plain addcart-btn"
              bindtap="onAddToCart"
              aria-label="Add to cart">
        Add to cart
      </button>
    </view>
  </view>
</view>